# 1. 机器学习/深度学习训练常见问题

## 1.1 常见训练数据使用方式；    
1.使用基础数据，通过技术指标统计多天，将时间维度压成1维（如5日均值，将5日统计为1日），即1支股票是一个（1*N）维度的特征,
  1为时间，N为特征的维度    
2.采用滑动窗口，保留时间维，即1支股票是一个（T*N）维度的特征   


## 1.2 特征选择     
不同周期，不同因子的重要性不同，因此，特征选择主要有一下方案：        
1.采用尽可能多的因子，因子不变，固定周期重训模型，以保持模型的稳定     
2.固定周期，根据因子权重，重选因子后，重训模型   


## 1.3 训练和验证数据拆分流程 （优选方案1或2）             
1.按时间段，比如2018年为训练，2019年为验证集，2020做测试集     
2.比如2018年等分切分为12分，奇数作训练，偶数做验证，2019做测试机     
3.对训练集直接打散后，7：3拆分为训练和验证集，小概率情况下出现行情好的都分到了训练集，
  行情差的都在验证集，可能导致训练的不好。


## 1.4 标签制作和使用
1.回归类标签：即使用实际股票价值，或者涨跌幅作为预测值，但往往误差较大，可能预测不准，虽然分析过程，
  通过绘图，可以看到预测趋势和真实值很接近，但实际误差仍然很大
2.分类标签：相对回归会更加准确，但是需要大量的尝试以及精细分类，比如最简单的分类，就是预测涨还是跌，
  如果分类详细一些，则是按涨跌幅度分为几类，进行预测。得到预测结果后，可以按照打分进行排序后选股。


## 1.5 回测中可能存在的问题     
### 1.5.1 模拟和真实的差异
回测和真是交易存在一定的差异，因此，只可能尽可能接近实际的模拟，但和真实存在一定差异，如：    
1.概率性买入失败：真实交易可能存在涨跌停导致没有买入或卖出，而回测无法很好的模拟    
2.滑点：由于价格快速实时波动，导致下单和实际成交价格存在差异，回测往往采用一个固定比率模拟    
3.交易值：回测往往采取一天的收盘价或者平均价作为交易价格，与实际存在差异

### 1.5.2 注意事项
需注意引入未来 （Attention注意对未来进行mask,其余模型对日期进行平移）

### 1.5.3 测试流程
如果回测周期很长，比如8年，那么行情好的期间可能掩盖行情不好期间的亏损问题。
因此，建议对牛市/熊市/长周期（比如连续2年+），之后对近期模拟交易跟踪，综合评定后，
如果策略Okay，则上线使用。